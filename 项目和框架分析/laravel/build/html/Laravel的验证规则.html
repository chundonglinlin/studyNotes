

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>63. 验证规则 &mdash; laravel 1.0 文档</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="索引"
              href="genindex.html"/>
        <link rel="search" title="搜索" href="search.html"/>
    <link rel="top" title="laravel 1.0 文档" href="index.html"/>
        <link rel="prev" title="62. Eloquent修改器" href="Laravel的数据库—Eloquent修改器.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> laravel
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">目录:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="请求到响应的生命周期-web.html">1. 请求到web响应的生命周期</a></li>
<li class="toctree-l1"><a class="reference internal" href="请求到响应的生命周期-console.html">2. 请求到console响应的生命周期</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的容器.html">3. 容器</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的Facades.html">4. Facades</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的Facades原理分析.html">5. Facade的原理</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的服务提供器.html">6. 服务提供器</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的路由.html">7. 路由</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的路由—路由的正则编译.html">8. 路由的正则编译</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的路由—路由的匹配与参数绑定.html">9. 路由的匹配与参数绑定</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的路由—路由中间件.html">10. 路由的中间件</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的中间件.html">11. 中间件</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的中间件-SubstituteBindings.html">12. 中间件SubstituteBindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的中间件-CSRF.html">13. 中间件CSRF</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的请求.html">14. 请求</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的控制器.html">15. 控制器</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的控制器—控制器方法的参数构建与运行.html">16. 控制器方法的参数构建与运行</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的响应.html">17. 响应</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的视图.html">18. 视图</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的生成URL.html">19. URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的Session.html">20. Session</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的Session原理分析.html">21. Session原理分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的表单验证机制详解.html">22. 表单验证机制详解</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的日志.html">23. 日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的异常和错误处理.html">24. 异常和错误处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的异常和错误处理原理分析.html">25. 异常和错误处理原理分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的Blade.html">26. Blade</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的blade原理分析.html">27. Blade原理分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的前端.html">28. 前端</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的Mix.html">29. Mix</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-mix.html">30. mix使用手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的用户认证系统.html">31. Laravel 的用户认证系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="用户认证JWT.html">32. 用户认证JWT</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的API认证系统Passport.html">33. Laravel 的 API 认证系统 Passport</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的用户授权系统.html">34. Laravel用户授权系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的命令行.html">35. 命令行</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的广播系统.html">36. 广播</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的广播系统原理分析.html">37. 广播系统原理分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的缓存系统.html">38. 缓存</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的集合Collection.html">39. 集合</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的事件系统.html">40. 事件</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的事件系统原理分析.html">41. 事件系统原理分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的文件存储.html">42. 文件存储</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的辅助函数-字符串操作.html">43. 辅助函数-字符串函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的辅助函数-数组和对象操作.html">44. 辅助函数-数组和对象函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的辅助函数-路径操作.html">45. 辅助函数-路径函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的辅助函数-tap分析.html">46. 辅助函数-Tap函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的辅助函数-其它.html">47. 辅助函数-其它杂项</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的邮件发送功能.html">48. 邮件</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的消息通知.html">49. 通知</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel Queue——消息队列任务与分发源码剖析.html">50. 消息队列任务与分发源码剖析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的任务调度.html">51. 任务调度</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据库—原始方式.html">52. 数据库-原始操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据库—查询构造器.html">53. 数据库-查询构建器</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据分页.html">54. 数据分页</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据分页原理分析.html">55. 数据分页原理分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据库迁移.html">56. 数据库迁移</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据库填充.html">57. 数据库填充</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的Redis.html">58. Redis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的Redis原理分析.html">59. Redis原理分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据库—Eloquent.html">60. Eloquent</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据库—Eloquent关联.html">61. Eloquent关联</a></li>
<li class="toctree-l1"><a class="reference internal" href="Laravel的数据库—Eloquent修改器.html">62. Eloquent修改器</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">63. 验证规则</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">63.1. 可用验证规则</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#accepted">63.1.1. accepted</a></li>
<li class="toctree-l3"><a class="reference internal" href="#active-url">63.1.2. active_url</a></li>
<li class="toctree-l3"><a class="reference internal" href="#after-date">63.1.3. after:date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#after-or-equal-date">63.1.4. after_or_equal:date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alpha">63.1.5. alpha</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alpha-dash">63.1.6. alpha_dash</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alpha-num">63.1.7. alpha_num</a></li>
<li class="toctree-l3"><a class="reference internal" href="#array">63.1.8. array</a></li>
<li class="toctree-l3"><a class="reference internal" href="#before-date">63.1.9. before:date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#before-or-equal-date">63.1.10. before_or_equal:date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#between-min-max">63.1.11. between:min,max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boolean">63.1.12. boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="#confirmed">63.1.13. confirmed</a></li>
<li class="toctree-l3"><a class="reference internal" href="#date">63.1.14. date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#date-equals-date">63.1.15. date_equals:date</a></li>
<li class="toctree-l3"><a class="reference internal" href="#date-format-format">63.1.16. date_format:format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#different-field">63.1.17. different:field</a></li>
<li class="toctree-l3"><a class="reference internal" href="#digits-value">63.1.18. digits:value</a></li>
<li class="toctree-l3"><a class="reference internal" href="#digits-between-min-max">63.1.19. digits_between:min,max</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dimensions">63.1.20. dimensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distinct">63.1.21. distinct</a></li>
<li class="toctree-l3"><a class="reference internal" href="#email">63.1.22. email</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exists-table-column">63.1.23. exists:table,column</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file">63.1.24. file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filled">63.1.25. filled</a></li>
<li class="toctree-l3"><a class="reference internal" href="#image">63.1.26. image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#in-foo-bar">63.1.27. in:foo,bar,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#in-array-anotherfield">63.1.28. in_array:anotherfield</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integer">63.1.29. integer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ip">63.1.30. ip</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ipv4">63.1.31. ipv4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ipv6">63.1.32. ipv6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#json">63.1.33. json</a></li>
<li class="toctree-l3"><a class="reference internal" href="#max-value">63.1.34. max:value</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mimetypes-text-plain">63.1.35. mimetypes:text/plain,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mimes-foo-bar">63.1.36. mimes:foo,bar,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#min-value">63.1.37. min:value</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nullable">63.1.38. nullable</a></li>
<li class="toctree-l3"><a class="reference internal" href="#not-in-foo-bar">63.1.39. not_in:foo,bar,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numeric">63.1.40. numeric</a></li>
<li class="toctree-l3"><a class="reference internal" href="#present">63.1.41. present</a></li>
<li class="toctree-l3"><a class="reference internal" href="#regex-pattern">63.1.42. regex:pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required">63.1.43. required</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-if-anotherfield-value">63.1.44. required_if:anotherfield,value,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-unless-anotherfield-value">63.1.45. required_unless:anotherfield,value,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-with-foo-bar">63.1.46. required_with:foo,bar,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-with-all-foo-bar">63.1.47. required_with_all:foo,bar,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-without-foo-bar">63.1.48. required_without:foo,bar,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-without-all-foo-bar">63.1.49. required_without_all:foo,bar,...</a></li>
<li class="toctree-l3"><a class="reference internal" href="#same-field">63.1.50. same:field</a></li>
<li class="toctree-l3"><a class="reference internal" href="#size-value">63.1.51. size:value</a></li>
<li class="toctree-l3"><a class="reference internal" href="#string">63.1.52. string</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timezone">63.1.53. timezone</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unique-table-column-except-idcolumn">63.1.54. unique:table,column,except,idColumn</a></li>
<li class="toctree-l3"><a class="reference internal" href="#url">63.1.55. url</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id3">63.2. 按条件增加规则</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">63.2.1. 存在才验证</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">63.2.2. 复杂的条件验证</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id6">63.3. 验证数组</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">63.4. 自定义验证规则</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">63.4.1. 使用规则对象</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">63.4.2. 使用闭包</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">63.4.3. 使用扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">63.4.4. 定义错误消息</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">63.4.5. 隐式扩展</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id17">63.5. 比较</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">laravel</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>63. 验证规则</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
        
        <a href="http://blog.liaozhonghao.cn" rel="nofollow"> 返回主页</a>
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>63. 验证规则<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<div class="section" id="id2">
<h2>63.1. 可用验证规则<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>以下是所有可用的验证规则及其功能的清单：</p>
<div class="section" id="accepted">
<h3>63.1.1. accepted<a class="headerlink" href="#accepted" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须为 <code class="docutils literal"><span class="pre">yes</span></code> ， <code class="docutils literal"><span class="pre">on</span></code> ， <code class="docutils literal"><span class="pre">1</span></code> ， <code class="docutils literal"><span class="pre">true</span></code> 。这在确认「服务条款」是否同意时相当有用。</p>
</div>
<div class="section" id="active-url">
<h3>63.1.2. active_url<a class="headerlink" href="#active-url" title="永久链接至标题">¶</a></h3>
<p>相当于使用了 <code class="docutils literal"><span class="pre">PHP</span></code> 函数 <a class="reference external" href="http://php.net/manual/zh/function.dns-get-record.php">dns_get_record</a> (获取指定主机的DNS记录)，验证的字段必须具有有效的 <code class="docutils literal"><span class="pre">A</span></code> 或 <code class="docutils literal"><span class="pre">AAAA</span></code> 记录。</p>
</div>
<div class="section" id="after-date">
<h3>63.1.3. after:date<a class="headerlink" href="#after-date" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是给定日期后的值。这个日期将会通过 PHP 函数 <code class="docutils literal"><span class="pre">strtotime</span></code> 来验证。</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;start_date&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|date|after:tomorrow&#39;</span>
</pre></div>
</div>
<p>您可以指定另一个字段与日期进行比较，而不是传递一个日期字符串用 <code class="docutils literal"><span class="pre">strtotime</span></code> 进行比较：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;finish_date&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|date|after:start_date&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="after-or-equal-date">
<h3>63.1.4. after_or_equal:date<a class="headerlink" href="#after-or-equal-date" title="永久链接至标题">¶</a></h3>
<p>验证的字段的值必须等于给定日期或在其之后。更多信息请参见 <code class="docutils literal"><span class="pre">after</span></code> 规则。</p>
</div>
<div class="section" id="alpha">
<h3>63.1.5. alpha<a class="headerlink" href="#alpha" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须完全由字母构成。</p>
</div>
<div class="section" id="alpha-dash">
<h3>63.1.6. alpha_dash<a class="headerlink" href="#alpha-dash" title="永久链接至标题">¶</a></h3>
<p>验证的字段可能具有字母、数字、破折号（ <code class="docutils literal"><span class="pre">-</span></code> ）以及下划线（ <code class="docutils literal"><span class="pre">_</span></code> ）。</p>
</div>
<div class="section" id="alpha-num">
<h3>63.1.7. alpha_num<a class="headerlink" href="#alpha-num" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须完全是字母、数字。</p>
</div>
<div class="section" id="array">
<h3>63.1.8. array<a class="headerlink" href="#array" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是一个 PHP 数组。</p>
</div>
<div class="section" id="before-date">
<h3>63.1.9. before:date<a class="headerlink" href="#before-date" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是给定日期之前的值。这个日期将会通过 PHP <code class="docutils literal"><span class="pre">strtotime</span></code> 函数来验证。</p>
</div>
<div class="section" id="before-or-equal-date">
<h3>63.1.10. before_or_equal:date<a class="headerlink" href="#before-or-equal-date" title="永久链接至标题">¶</a></h3>
<p>验证的字段的值必须等于给定日期或在其之前。这个日期将会使用 PHP <code class="docutils literal"><span class="pre">strtotime</span></code> 函数来验证。</p>
</div>
<div class="section" id="between-min-max">
<h3>63.1.11. between:min,max<a class="headerlink" href="#between-min-max" title="永久链接至标题">¶</a></h3>
<p>验证的字段的大小必须在给定的 <code class="docutils literal"><span class="pre">min</span></code> 和 <code class="docutils literal"><span class="pre">max</span></code> 之间。字符串、数字、数组或是文件大小的计算方式都用 <code class="docutils literal"><span class="pre">size</span></code> 方法。</p>
</div>
<div class="section" id="boolean">
<h3>63.1.12. boolean<a class="headerlink" href="#boolean" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须能够被转换为布尔值。可接受的参数为 <code class="docutils literal"><span class="pre">true</span></code> , <code class="docutils literal"><span class="pre">false</span></code> , <code class="docutils literal"><span class="pre">1</span></code> , <code class="docutils literal"><span class="pre">0</span></code> , <code class="docutils literal"><span class="pre">&quot;1&quot;</span></code> , 以及 <code class="docutils literal"><span class="pre">&quot;0&quot;</span></code> 。</p>
</div>
<div class="section" id="confirmed">
<h3>63.1.13. confirmed<a class="headerlink" href="#confirmed" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须和 <code class="docutils literal"><span class="pre">foo_confirmation</span></code> 的字段值一致。例如，如果要验证的字段是 <code class="docutils literal"><span class="pre">password</span></code> ，输入中必须存在匹配的 <code class="docutils literal"><span class="pre">password_confirmation</span></code> 字段。</p>
</div>
<div class="section" id="date">
<h3>63.1.14. date<a class="headerlink" href="#date" title="永久链接至标题">¶</a></h3>
<p>验证的字段值必须是通过 PHP 函数 <code class="docutils literal"><span class="pre">strtotime</span></code> 校验的有效日期。</p>
</div>
<div class="section" id="date-equals-date">
<h3>63.1.15. date_equals:date<a class="headerlink" href="#date-equals-date" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须等于给定的日期。该日期会被传递到 PHP <code class="docutils literal"><span class="pre">strtotime</span></code> 函数。</p>
</div>
<div class="section" id="date-format-format">
<h3>63.1.16. date_format:format<a class="headerlink" href="#date-format-format" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须与给定的格式相匹配。你应该只使用 <code class="docutils literal"><span class="pre">date</span></code> 或 <code class="docutils literal"><span class="pre">date_format</span></code> 中的 其中一个 用于验证，而不应该同时使用两者。</p>
</div>
<div class="section" id="different-field">
<h3>63.1.17. different:field<a class="headerlink" href="#different-field" title="永久链接至标题">¶</a></h3>
<p>验证的字段值必须与字段 ( <code class="docutils literal"><span class="pre">field</span></code> ) 的值不同。</p>
</div>
<div class="section" id="digits-value">
<h3>63.1.18. digits:value<a class="headerlink" href="#digits-value" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是 数字 ，并且必须具有确切的 值。</p>
</div>
<div class="section" id="digits-between-min-max">
<h3>63.1.19. digits_between:min,max<a class="headerlink" href="#digits-between-min-max" title="永久链接至标题">¶</a></h3>
<p>验证的字段的长度必须在给定的 最小值 和 最大值 之间。</p>
</div>
<div class="section" id="dimensions">
<h3>63.1.20. dimensions<a class="headerlink" href="#dimensions" title="永久链接至标题">¶</a></h3>
<p>验证的文件必须是图片并且图片比例必须符合规则：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;avatar&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dimensions:min_width=100,min_height=200&#39;</span>
</pre></div>
</div>
<p>可用的规则为: <code class="docutils literal"><span class="pre">min_width</span></code> ， <code class="docutils literal"><span class="pre">max_width</span></code> ， <code class="docutils literal"><span class="pre">min_height</span></code> ， <code class="docutils literal"><span class="pre">max_height</span></code> ， <code class="docutils literal"><span class="pre">width</span></code> ， <code class="docutils literal"><span class="pre">height</span></code> ， <code class="docutils literal"><span class="pre">ratio</span></code> 。</p>
<p><code class="docutils literal"><span class="pre">ratio</span></code> 约束应该表示为宽度除以高度。 这可以通过像 <code class="docutils literal"><span class="pre">3/2</span></code> 这样的语句或像 <code class="docutils literal"><span class="pre">1.5</span></code> 这样的 <code class="docutils literal"><span class="pre">float</span></code> 来指定：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;avatar&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;dimensions:ratio=3/2&#39;</span>
</pre></div>
</div>
<p>由于此规则需要多个参数，因此你可以 <code class="docutils literal"><span class="pre">Rule::dimensions</span></code> 方法来构造可读性高的规则：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Illuminate\Validation\Rule</span><span class="p">;</span>

<span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;avatar&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="nx">Rule</span><span class="o">::</span><span class="na">dimensions</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">maxWidth</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">maxHeight</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">ratio</span><span class="p">(</span><span class="mi">3</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="distinct">
<h3>63.1.21. distinct<a class="headerlink" href="#distinct" title="永久链接至标题">¶</a></h3>
<p>验证数组时，指定的字段不能有任何重复值。</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">&#39;foo.*.id&#39; =&gt; &#39;distinct&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="email">
<h3>63.1.22. email<a class="headerlink" href="#email" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须符合 e-mail 地址格式。</p>
</div>
<div class="section" id="exists-table-column">
<h3>63.1.23. exists:table,column<a class="headerlink" href="#exists-table-column" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须存在于给定的数据库表中。</p>
<p>Exists 规则的基本用法</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;state&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;exists:states&#39;</span>
</pre></div>
</div>
<p>指定自定义字段名称</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;state&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;exists:states,abbreviation&#39;</span>
</pre></div>
</div>
<p>如果你需要指定 <code class="docutils literal"><span class="pre">exists</span></code> 方法用来查询的数据库。你可以通过使用「点」语法将数据库的名称添加到数据表前面来实现这个目的：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;exists:connection.staff,email&#39;</span>
</pre></div>
</div>
<p>如果要自定义验证规则执行的查询，可以使用 <code class="docutils literal"><span class="pre">Rule</span></code> 类来定义规则。在这个例子中，我们使用数组指定验证规则，而不是使用 <code class="docutils literal"><span class="pre">|</span></code> 字符来分隔它们：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Illuminate\Validation\Rule</span><span class="p">;</span>

<span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="nx">Rule</span><span class="o">::</span><span class="na">exists</span><span class="p">(</span><span class="s1">&#39;staff&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;account_id&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="p">}),</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="file">
<h3>63.1.24. file<a class="headerlink" href="#file" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是成功上传的文件。</p>
</div>
<div class="section" id="filled">
<h3>63.1.25. filled<a class="headerlink" href="#filled" title="永久链接至标题">¶</a></h3>
<p>验证的字段在存在时不能为空。</p>
</div>
<div class="section" id="image">
<h3>63.1.26. image<a class="headerlink" href="#image" title="永久链接至标题">¶</a></h3>
<p>验证的文件必须是一个图像（ jpeg、png、bmp、gif、或 svg ）。</p>
</div>
<div class="section" id="in-foo-bar">
<h3>63.1.27. in:foo,bar,...<a class="headerlink" href="#in-foo-bar" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须包含在给定的值列表中。因为这个规则通常需要你 <code class="docutils literal"><span class="pre">implode</span></code> 一个数组， <code class="docutils literal"><span class="pre">Rule::in</span></code> 方法可以用来构造规则：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Illuminate\Validation\Rule</span><span class="p">;</span>

<span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;zones&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="nx">Rule</span><span class="o">::</span><span class="na">in</span><span class="p">([</span><span class="s1">&#39;first-zone&#39;</span><span class="p">,</span> <span class="s1">&#39;second-zone&#39;</span><span class="p">]),</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="in-array-anotherfield">
<h3>63.1.28. in_array:anotherfield<a class="headerlink" href="#in-array-anotherfield" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须存在于另一个字段 <code class="docutils literal"><span class="pre">anotherfield</span></code> 的值中。</p>
</div>
<div class="section" id="integer">
<h3>63.1.29. integer<a class="headerlink" href="#integer" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是整数。</p>
</div>
<div class="section" id="ip">
<h3>63.1.30. ip<a class="headerlink" href="#ip" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是 <code class="docutils literal"><span class="pre">IP</span></code> 地址。</p>
</div>
<div class="section" id="ipv4">
<h3>63.1.31. ipv4<a class="headerlink" href="#ipv4" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是 <code class="docutils literal"><span class="pre">IPv4</span></code> 地址。</p>
</div>
<div class="section" id="ipv6">
<h3>63.1.32. ipv6<a class="headerlink" href="#ipv6" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是 <code class="docutils literal"><span class="pre">IPv6</span></code> 地址。</p>
</div>
<div class="section" id="json">
<h3>63.1.33. json<a class="headerlink" href="#json" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是有效的 <code class="docutils literal"><span class="pre">JSON</span></code> 字符串。</p>
</div>
<div class="section" id="max-value">
<h3>63.1.34. max:value<a class="headerlink" href="#max-value" title="永久链接至标题">¶</a></h3>
<p>验证中的字段必须小于或等于 <code class="docutils literal"><span class="pre">value</span></code> 。字符串、数字、数组或是文件大小的计算方式都用 <code class="docutils literal"><span class="pre">size</span></code> 方法进行评估。</p>
</div>
<div class="section" id="mimetypes-text-plain">
<h3>63.1.35. mimetypes:text/plain,...<a class="headerlink" href="#mimetypes-text-plain" title="永久链接至标题">¶</a></h3>
<p>验证的文件必须与给定 <code class="docutils literal"><span class="pre">MIME</span></code> 类型之一匹配：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;video&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mimetypes:video/avi,video/mpeg,video/quicktime&#39;</span>
</pre></div>
</div>
<p>要确定上传文件的 <code class="docutils literal"><span class="pre">MIME</span></code> 类型，会读取文件的内容来判断 <code class="docutils literal"><span class="pre">MIME</span></code> 类型，这可能与客户端提供的 <code class="docutils literal"><span class="pre">MIME</span></code> 类型不同。</p>
</div>
<div class="section" id="mimes-foo-bar">
<h3>63.1.36. mimes:foo,bar,...<a class="headerlink" href="#mimes-foo-bar" title="永久链接至标题">¶</a></h3>
<p>验证的文件必须具有与列出的其中一个扩展名相对应的 <code class="docutils literal"><span class="pre">MIME</span></code> 类型。</p>
<p><code class="docutils literal"><span class="pre">MIME</span></code> 规则基本用法</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;photo&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;mimes:jpeg,bmp,png&#39;</span>
</pre></div>
</div>
<p>即使你可能只需要验证指定扩展名，但此规则实际上会验证文件的 <code class="docutils literal"><span class="pre">MIME</span></code> 类型，其通过读取文件的内容以猜测它的 <code class="docutils literal"><span class="pre">MIME</span></code> 类型。</p>
<p>可以在以下链接中找到完整的 <code class="docutils literal"><span class="pre">MIME</span></code> 类型列表及其相应的扩展名：
<a class="reference external" href="https://svn.apache.org/repos/asf/httpd/httpd/trunk/docs/conf/mime.types">https://svn.apache.org/repos/asf/httpd/httpd/trunk/docs/conf/mime.types</a></p>
</div>
<div class="section" id="min-value">
<h3>63.1.37. min:value<a class="headerlink" href="#min-value" title="永久链接至标题">¶</a></h3>
<p>验证中的字段必须具有最小值。字符串、数字、数组或是文件大小的计算方式都用 <code class="docutils literal"><span class="pre">size</span></code> 方法进行评估。</p>
</div>
<div class="section" id="nullable">
<h3>63.1.38. nullable<a class="headerlink" href="#nullable" title="永久链接至标题">¶</a></h3>
<p>验证的字段可以为 <code class="docutils literal"><span class="pre">null</span></code> 。这在验证基本数据类型时特别有用，例如可以包含空值的字符串和整数。</p>
</div>
<div class="section" id="not-in-foo-bar">
<h3>63.1.39. not_in:foo,bar,...<a class="headerlink" href="#not-in-foo-bar" title="永久链接至标题">¶</a></h3>
<p>验证的字段不能包含在给定的值列表中。 <code class="docutils literal"><span class="pre">Rule::notIn</span></code> 方法可以用来构建规则：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Illuminate\Validation\Rule</span><span class="p">;</span>

<span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;toppings&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="nx">Rule</span><span class="o">::</span><span class="na">notIn</span><span class="p">([</span><span class="s1">&#39;sprinkles&#39;</span><span class="p">,</span> <span class="s1">&#39;cherries&#39;</span><span class="p">]),</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="numeric">
<h3>63.1.40. numeric<a class="headerlink" href="#numeric" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是数字。</p>
</div>
<div class="section" id="present">
<h3>63.1.41. present<a class="headerlink" href="#present" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须存在于输入数据中，但可以为空。</p>
</div>
<div class="section" id="regex-pattern">
<h3>63.1.42. regex:pattern<a class="headerlink" href="#regex-pattern" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须与给定的正则表达式匹配。</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">当使用 <code class="docutils literal"><span class="pre">regex</span></code> 规则时，你必须使用数组，而不是使用 <code class="docutils literal"><span class="pre">|</span></code> 分隔符，特别是如果正则表达式包含 <code class="docutils literal"><span class="pre">|</span></code> 字符。</p>
</div>
</div>
<div class="section" id="required">
<h3>63.1.43. required<a class="headerlink" href="#required" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须存在于输入数据中，而不是空。如果满足以下条件之一，则字段被视为「空」：</p>
<ul class="simple">
<li>值为 <code class="docutils literal"><span class="pre">null</span></code> ；</li>
<li>值为空字符串；</li>
<li>值为空数组或空 <code class="docutils literal"><span class="pre">Countable</span></code> 对象；</li>
<li>值为无路径的上传文件；</li>
</ul>
</div>
<div class="section" id="required-if-anotherfield-value">
<h3>63.1.44. required_if:anotherfield,value,...<a class="headerlink" href="#required-if-anotherfield-value" title="永久链接至标题">¶</a></h3>
<p>如果 <code class="docutils literal"><span class="pre">anotherfield</span></code> 字段等于任一 <code class="docutils literal"><span class="pre">value</span></code> ，验证的字段必须出现且不为空 。</p>
</div>
<div class="section" id="required-unless-anotherfield-value">
<h3>63.1.45. required_unless:anotherfield,value,...<a class="headerlink" href="#required-unless-anotherfield-value" title="永久链接至标题">¶</a></h3>
<p>如果 <code class="docutils literal"><span class="pre">anotherfield</span></code> 字段不等于任一 <code class="docutils literal"><span class="pre">value</span></code> ，验证的字段必须出现且不为空。</p>
</div>
<div class="section" id="required-with-foo-bar">
<h3>63.1.46. required_with:foo,bar,...<a class="headerlink" href="#required-with-foo-bar" title="永久链接至标题">¶</a></h3>
<p>只有在其他任一指定字段出现时，验证的字段才必须出现且不为空。</p>
</div>
<div class="section" id="required-with-all-foo-bar">
<h3>63.1.47. required_with_all:foo,bar,...<a class="headerlink" href="#required-with-all-foo-bar" title="永久链接至标题">¶</a></h3>
<p>只有在其他指定字段全部出现时，验证的字段才必须出现且不为空。</p>
</div>
<div class="section" id="required-without-foo-bar">
<h3>63.1.48. required_without:foo,bar,...<a class="headerlink" href="#required-without-foo-bar" title="永久链接至标题">¶</a></h3>
<p>只在其他指定任一字段不出现时，验证的字段才必须出现且不为空。</p>
</div>
<div class="section" id="required-without-all-foo-bar">
<h3>63.1.49. required_without_all:foo,bar,...<a class="headerlink" href="#required-without-all-foo-bar" title="永久链接至标题">¶</a></h3>
<p>只有在其他指定字段全部不出现时，验证的字段才必须出现且不为空。</p>
</div>
<div class="section" id="same-field">
<h3>63.1.50. same:field<a class="headerlink" href="#same-field" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须与给定字段匹配。??</p>
</div>
<div class="section" id="size-value">
<h3>63.1.51. size:value<a class="headerlink" href="#size-value" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须具有与给定值匹配的大小。对于字符串， <code class="docutils literal"><span class="pre">value</span></code> 对应字符数。对于数字， <code class="docutils literal"><span class="pre">value</span></code> 对应给定的整数值。对于数组， <code class="docutils literal"><span class="pre">size</span></code> 对应数组的 <code class="docutils literal"><span class="pre">count</span></code> 值。对于文件， <code class="docutils literal"><span class="pre">size</span></code> 对应文件大小（单位kb）。</p>
</div>
<div class="section" id="string">
<h3>63.1.52. string<a class="headerlink" href="#string" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是一个字符串。如果允许这个字段为 <code class="docutils literal"><span class="pre">null</span></code> ，需要给这个字段分配 <code class="docutils literal"><span class="pre">nullable</span></code> 规则。</p>
</div>
<div class="section" id="timezone">
<h3>63.1.53. timezone<a class="headerlink" href="#timezone" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是一个基于 PHP 函数 <code class="docutils literal"><span class="pre">timezone_identifiers_list</span></code> 的有效时区标识。</p>
</div>
<div class="section" id="unique-table-column-except-idcolumn">
<h3>63.1.54. unique:table,column,except,idColumn<a class="headerlink" href="#unique-table-column-except-idcolumn" title="永久链接至标题">¶</a></h3>
<p>验证的字段在给定的数据库表中必须是唯一的。如果没有指定 <code class="docutils literal"><span class="pre">column</span></code> ，将会使用字段本身的名称。</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">你必须同时在数据库中对指定字段设置唯一索引限制，否则在此版本中并不能达到唯一目的。</p>
</div>
<p>指定自定义字段名称：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;unique:users,email_address&#39;</span>
</pre></div>
</div>
<p>自定义数据库连接</p>
<p>有时，你可能需要为验证程序创建的数据库查询设置自定义连接。上面的例子中，将 <code class="docutils literal"><span class="pre">unique:users</span></code> 设置为验证规则，等于使用默认数据库连接来查询数据库。如果要对其进行修改，请使用「点」方法指定连接和表名：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;unique:connection.users,email_address&#39;</span>
</pre></div>
</div>
<p>强迫 Unique 规则忽略指定 ID ：</p>
<p>有时，你可能希望在进行字段唯一性验证时忽略指定 <code class="docutils literal"><span class="pre">ID</span></code> 。例如， 在「更新个人资料」页面会包含用户名、邮箱和地点。这时你会想要验证更新的 <code class="docutils literal"><span class="pre">E-mail</span></code> 值是否唯一。如果用户仅更改了用户名字段而没有改 <code class="docutils literal"><span class="pre">E-mail</span></code> 字段，就不需要抛出验证错误，因为此用户已经是这个 <code class="docutils literal"><span class="pre">E-mail</span></code> 的拥有者了。</p>
<p>使用 <code class="docutils literal"><span class="pre">Rule</span></code> 类定义规则来指示验证器忽略用户的 <code class="docutils literal"><span class="pre">ID</span></code> 。这个例子中通过数组来指定验证规则，而不是使用 <code class="docutils literal"><span class="pre">|</span></code> 字符来分隔：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">Illuminate\Validation\Rule</span><span class="p">;</span>

<span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="nx">Rule</span><span class="o">::</span><span class="na">unique</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">ignore</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>如果你的数据表使用的主键名称不是 <code class="docutils literal"><span class="pre">id</span></code> ，那就在调用 <code class="docutils literal"><span class="pre">ignore</span></code> 方法时指定字段的名称：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="nx">Rule</span><span class="o">::</span><span class="na">unique</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">ignore</span><span class="p">(</span><span class="nv">$user</span><span class="o">-&gt;</span><span class="na">id</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>增加额外的 Where 语句：</p>
<p>你也可以通过 <code class="docutils literal"><span class="pre">where</span></code> 方法指定额外的查询条件。例如， 我们添加 <code class="docutils literal"><span class="pre">account_id</span></code> 为 <code class="docutils literal"><span class="pre">1</span></code> 的约束：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="nx">Rule</span><span class="o">::</span><span class="na">unique</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$query</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$query</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;account_id&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="url">
<h3>63.1.55. url<a class="headerlink" href="#url" title="永久链接至标题">¶</a></h3>
<p>验证的字段必须是有效的 <code class="docutils literal"><span class="pre">URL</span></code> 。</p>
</div>
</div>
<div class="section" id="id3">
<h2>63.2. 按条件增加规则<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<div class="section" id="id4">
<h3>63.2.1. 存在才验证<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>在某些情况下，只有在该字段存在于数组中时， 才可以对字段执行验证检查。可通过增加 <code class="docutils literal"><span class="pre">sometimes</span></code> 到规则列表来实现：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$v</span> <span class="o">=</span> <span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;sometimes|required|email&#39;</span><span class="p">,</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>在上面的例子中， <code class="docutils literal"><span class="pre">email</span></code> 字段只有在 <code class="docutils literal"><span class="pre">$data</span></code> 数组中存在才会被验证。</p>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">如果你尝试验证应该始终存在但可能为空的字段，请查阅 可选字段的注意事项</p>
</div>
</div>
<div class="section" id="id5">
<h3>63.2.2. 复杂的条件验证<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<p>有时候你可能需要增加基于更复杂的条件逻辑的验证规则。例如，你可以希望某个指定字段在另一个字段的值超过 <code class="docutils literal"><span class="pre">100</span></code> 时才为必填。或者当某个指定字段存在时，另外两个字段才能具有给定的值。增加这样的验证条件并不难。首先，使用 静态规则 创建一个 <code class="docutils literal"><span class="pre">Validator</span></code> 实例：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$v</span> <span class="o">=</span> <span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|email&#39;</span><span class="p">,</span>
    <span class="s1">&#39;games&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|numeric&#39;</span><span class="p">,</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>假设我们有一个专为游戏收藏家所设计的网页应用程序。如果游戏收藏家收藏超过一百款游戏，我们会希望他们来说明下为什么他们会拥有这么多游戏。比如说他们有可能经营了一家游戏分销商店，或者只是为了享受收集的乐趣。为了在特定条件下加入此验证需求，可以在 <code class="docutils literal"><span class="pre">Validator</span></code> 实例中使用 <code class="docutils literal"><span class="pre">sometimes</span></code> 方法。</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$v</span><span class="o">-&gt;</span><span class="na">sometimes</span><span class="p">(</span><span class="s1">&#39;reason&#39;</span><span class="p">,</span> <span class="s1">&#39;required|max:500&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$input</span><span class="o">-&gt;</span><span class="na">games</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</div>
<p>传入 <code class="docutils literal"><span class="pre">sometimes</span></code> 方法的第一个参数是要用来验证的字段名称。第二个参数是我们想使用的验证规则。 闭包 作为第三个参数传入，如果其返回 <code class="docutils literal"><span class="pre">true</span></code> ， 则额外的规则就会被加入。这个方法可以轻松地创建复杂的条件验证。你甚至可以一次对多个字段增加条件验证：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$v</span><span class="o">-&gt;</span><span class="na">sometimes</span><span class="p">([</span><span class="s1">&#39;reason&#39;</span><span class="p">,</span> <span class="s1">&#39;cost&#39;</span><span class="p">],</span> <span class="s1">&#39;required&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$input</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$input</span><span class="o">-&gt;</span><span class="na">games</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">小技巧</p>
<p class="last">传入 闭包 的 <code class="docutils literal"><span class="pre">$input</span></code> 参数是 <code class="docutils literal"><span class="pre">Illuminate\Support\Fluent</span></code> 的一个实例，可用来访问你的输入或文件对象。</p>
</div>
</div>
</div>
<div class="section" id="id6">
<h2>63.3. 验证数组<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h2>
<p>验证表单的输入为数组的字段也不难。你可以使用 「点」方法来验证数组中的属性。例如，如果传入的 HTTP 请求中包含 <code class="docutils literal"><span class="pre">photos[profile]</span></code> 字段， 可以如下验证：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$validator</span> <span class="o">=</span> <span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">(),</span> <span class="p">[</span>
    <span class="s1">&#39;photos.profile&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required|image&#39;</span><span class="p">,</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>你也可以验证数组中的每个元素。例如，要验证指定数组输入字段中的每一个 <code class="docutils literal"><span class="pre">email</span></code> 是唯一的，可以这么做：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$validator</span> <span class="o">=</span> <span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">(),</span> <span class="p">[</span>
    <span class="s1">&#39;person.*.email&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;email|unique:users&#39;</span><span class="p">,</span>
    <span class="s1">&#39;person.*.first_name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;required_with:person.*.last_name&#39;</span><span class="p">,</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>同理，你可以在语言文件定义验证信息时使用 <code class="docutils literal"><span class="pre">*</span></code> 字符，为基于数组的字段使用单个验证消息：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="s1">&#39;custom&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">&#39;person.*.email&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;unique&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Each person must have a unique e-mail address&#39;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">],</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>63.4. 自定义验证规则<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h2>
<div class="section" id="id8">
<h3>63.4.1. 使用规则对象<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>Laravel 提供了许多有用的验证规则，同时也支持自定义规则。注册自定义验证规则的方法之一，就是使用规则对象。可以使用 <code class="docutils literal"><span class="pre">Artisan</span></code> 命令 <code class="docutils literal"><span class="pre">make:rule</span></code> 来生成新的规则对象。接下来，让我们用这个命令生成一个验证字符串是大写的规则。 Laravel 会将新的规则存放在 <code class="docutils literal"><span class="pre">app/Rules</span></code> 目录中：</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>php artisan make:rule Uppercase
</pre></div>
</div>
<p>一旦创建了规则，我们就可以定义它的行为。规则对象包含两个方法： <code class="docutils literal"><span class="pre">passes</span></code> 和 <code class="docutils literal"><span class="pre">message</span></code> 。 <code class="docutils literal"><span class="pre">passes</span></code> 方法接收属性值和名称，并根据属性值是否符合规则而返回 <code class="docutils literal"><span class="pre">true</span></code> 或者 <code class="docutils literal"><span class="pre">false</span></code> 。 <code class="docutils literal"><span class="pre">message</span></code> 方法应返回验证失败时应使用的验证错误消息：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="k">namespace</span> <span class="nx">App\Rules</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Illuminate\Contracts\Validation\Rule</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Uppercase</span> <span class="k">implements</span> <span class="nx">Rule</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * 判断验证规则是否通过。</span>
<span class="sd">     *</span>
<span class="sd">     * @param  string  $attribute</span>
<span class="sd">     * @param  mixed  $value</span>
<span class="sd">     * @return bool</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">passes</span><span class="p">(</span><span class="nv">$attribute</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$value</span><span class="p">)</span> <span class="o">===</span> <span class="nv">$value</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * 获取验证错误消息。</span>
<span class="sd">     *</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">message</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;The :attribute must be uppercase.&#39;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>当然， 如果你希望从翻译文件中返回一个错误消息，你可以从 <code class="docutils literal"><span class="pre">message</span></code> 方法中调用辅助函数 <code class="docutils literal"><span class="pre">trans</span></code> ：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * 获取验证错误消息。</span>
<span class="sd"> *</span>
<span class="sd"> * @return string</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">message</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nx">trans</span><span class="p">(</span><span class="s1">&#39;validation.uppercase&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>一旦规则对象被定义好后，你可以通过将规则对象的实例和其他验证规则一起来传递给验证器：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">use</span> <span class="nx">App\Rules\Uppercase</span><span class="p">;</span>

<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">([</span>
    <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;required&#39;</span><span class="p">,</span> <span class="k">new</span> <span class="nx">Uppercase</span><span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>63.4.2. 使用闭包<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h3>
<p>如果你在应用程序中只需要一次自定义规则的功能，则可以使用闭包而不是规则对象。闭包接收属性的名称，属性的值以及如果验证失败应该调用的 <code class="docutils literal"><span class="pre">$fail</span></code> 回调：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$validator</span> <span class="o">=</span> <span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">(),</span> <span class="p">[</span>
    <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">&#39;required&#39;</span><span class="p">,</span>
        <span class="s1">&#39;max:255&#39;</span><span class="p">,</span>
        <span class="k">function</span><span class="p">(</span><span class="nv">$attribute</span><span class="p">,</span> <span class="nv">$value</span><span class="p">,</span> <span class="nv">$fail</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$value</span> <span class="o">===</span> <span class="s1">&#39;foo&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nv">$fail</span><span class="p">(</span><span class="nv">$attribute</span><span class="o">.</span><span class="s1">&#39; is invalid.&#39;</span><span class="p">);</span> <span class="c1">// 调用传入的回调函数，并传入验证失败的消息</span>
            <span class="p">}</span>
        <span class="p">},</span>
    <span class="p">],</span>
<span class="p">]);</span>
</pre></div>
</div>
<p>文件 <code class="docutils literal"><span class="pre">\Illuminate\Validation\ClosureValidationRule</span></code></p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">passes</span><span class="p">(</span><span class="nv">$attribute</span><span class="p">,</span> <span class="nv">$value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">failed</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="c1">// 这个方式奇怪？？</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">callback</span><span class="o">-&gt;</span><span class="na">__invoke</span><span class="p">(</span><span class="nv">$attribute</span><span class="p">,</span> <span class="nv">$value</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">failed</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">message</span> <span class="o">=</span> <span class="nv">$message</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="o">!</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">failed</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h3>63.4.3. 使用扩展<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
<p>另外一个注册自定义验证规则的方法，就是使用 <code class="docutils literal"><span class="pre">Validator</span></code> facade 中的 <code class="docutils literal"><span class="pre">extend</span></code> 方法。让我们在 服务容器 中使用这个方法来注册自定义验证规则：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">App\Providers</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Illuminate\Support\ServiceProvider</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Support\Facades\Validator</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">AppServiceProvider</span> <span class="k">extends</span> <span class="nx">ServiceProvider</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * 引导任何应用服务。</span>
<span class="sd">     *</span>
<span class="sd">     * @return void</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">boot</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nx">Validator</span><span class="o">::</span><span class="na">extend</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$attribute</span><span class="p">,</span> <span class="nv">$value</span><span class="p">,</span> <span class="nv">$parameters</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$value</span> <span class="o">==</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * 注册服务提供器。</span>
<span class="sd">     *</span>
<span class="sd">     * @return void</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">register</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">//</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>自定义的验证闭包接收四个参数：要被验证的属性名称 <code class="docutils literal"><span class="pre">$attribute</span></code> 、属性的值 <code class="docutils literal"><span class="pre">$value</span></code> 、传入验证规则的参数数组 <code class="docutils literal"><span class="pre">$parameters</span></code> 、及 <code class="docutils literal"><span class="pre">Validator</span></code> 实例。</p>
<p>除了使用闭包，你也可以传入类和方法到 <code class="docutils literal"><span class="pre">extend</span></code> 方法中：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="x">Validator::extend(&#39;foo&#39;, &#39;FooValidator@validate&#39;);</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h3>63.4.4. 定义错误消息<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
<p>你还需要为自定义规则定义错误信息。你可以使用内联自定义消息数组或者在验证语言文件中添加条目来实现这一功能。消息应该被放到数组的第一位， 而不是在只用于存放属性指定错误信息的 <code class="docutils literal"><span class="pre">custom</span></code> 数组内(不放置在 <code class="docutils literal"><span class="pre">custom</span></code> 数组内，则是针对特定验证规则的错误消息，不针对具体的属性)：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="c1">// 内联自定义消息数组</span>
<span class="nx">Validator</span><span class="o">::</span><span class="na">extend</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;FooValidator@validate&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s2">&quot;foo&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Your input was invalid!&quot;</span><span class="p">,</span>
    <span class="s2">&quot;accepted&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;The :attribute must be accepted.&quot;</span><span class="p">,</span>
    <span class="c1">// 其余的验证错误消息...</span>
<span class="p">]);</span>

<span class="c1">// resources/lang/xx/validation.php文件内容</span>
<span class="p">[</span>
  <span class="s1">&#39;foo&#39;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Your input was invalid!&quot;</span><span class="p">,</span>
<span class="p">],</span>
</pre></div>
</div>
<p>当创建一个自定义验证规则时，你可能有时候需要为错误信息定义 <a href="#id12"><span class="problematic" id="id13">**</span></a>自定义占位符 <a href="#id14"><span class="problematic" id="id15">**</span></a>。可以通过创建自定义验证器然后调用 <code class="docutils literal"><span class="pre">Validator</span></code> 门面上的 <code class="docutils literal"><span class="pre">replacer</span></code> 方法来进行该自定义占位符的替换。你可以在 服务提供者 的 <code class="docutils literal"><span class="pre">boot</span></code> 方法中执行如下操作：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * 启动应用服务.</span>
<span class="sd"> *</span>
<span class="sd"> * @return void</span>
<span class="sd"> */</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">boot</span><span class="p">()</span>
<span class="p">{</span>
    <span class="nx">Validator</span><span class="o">::</span><span class="na">extend</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>

    <span class="nx">Validator</span><span class="o">::</span><span class="na">replacer</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$message</span><span class="p">,</span> <span class="nv">$attribute</span><span class="p">,</span> <span class="nv">$rule</span><span class="p">,</span> <span class="nv">$parameters</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">str_replace</span><span class="p">(</span><span class="o">...</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h3>63.4.5. 隐式扩展<a class="headerlink" href="#id16" title="永久链接至标题">¶</a></h3>
<p>默认情况下， 当所要验证的属性不存在或包含由 <code class="docutils literal"><span class="pre">required</span></code> 规则定义的空值时，那么正常的验证规则，包括自定义扩展将不会执行。 例如， <code class="docutils literal"><span class="pre">unique</span></code> 规则将不会检验 <code class="docutils literal"><span class="pre">null</span></code> 值：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$rules</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;unique&#39;</span><span class="p">];</span>

<span class="nv">$input</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="k">null</span><span class="p">];</span>

<span class="nx">Validator</span><span class="o">::</span><span class="na">make</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$rules</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">passes</span><span class="p">();</span> <span class="c1">// true</span>
</pre></div>
</div>
<p>如果要求即使为空时也要验证属性，则必须要暗示属性是必须的，要创建这样一个「隐式」扩展，可以使用 <code class="docutils literal"><span class="pre">Validator::extendImplicit()</span></code> 方法：</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nx">Validator</span><span class="o">::</span><span class="na">extendImplicit</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$attribute</span><span class="p">,</span> <span class="nv">$value</span><span class="p">,</span> <span class="nv">$parameters</span><span class="p">,</span> <span class="nv">$validator</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$value</span> <span class="o">==</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">隐式」扩展只 暗示 该属性是必需的。至于它到底是缺失的还是空值这取决于你。</p>
</div>
</div>
</div>
<div class="section" id="id17">
<h2>63.5. 比较<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li>required 验证字段必须出现在输入数据中、不能为空。</li>
<li>present 验证字段必须出现在输入数据中、能为空。</li>
<li>filled 验证字段可不在输入数据中。当验证字段出现在输入数据中时，不能为空。</li>
<li>nullable 验证字段的值可以是 null。</li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="Laravel的数据库—Eloquent修改器.html" class="btn btn-neutral" title="62. Eloquent修改器" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, lzh.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            LANGUAGE:'zh',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  

<script type="text/javascript">
  
      $(document).ready(function(){
        var offset = sessionStorage.getItem("offsetTop");
        $('.wy-side-scroll').scrollTop(offset);
        sessionStorage.setItem("offsetTop", 0);


        $('.wy-menu > ul').click(function(){
            sessionStorage.setItem("offsetTop", $('.wy-side-scroll').scrollTop());
        });
      })

  </script> 

</body>
</html>